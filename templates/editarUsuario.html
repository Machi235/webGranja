{% extends "base.html" %}

{% block titulo %}Editar Usuario{% endblock %}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/registro.css') }}">
{% endblock %}

{% block contenido %}
<div class="login-container">

  <!-- Sección izquierda: formulario -->
  <div class="login-form">
    <h3>Editar Usuario</h3>

    <!-- Importante: enctype para fotos -->
    <form id="formEditar" 
          method="POST" 
          action="{{ url_for('auth.actualizar_usuario', idUsuario=usuario.idUsuario) }}"
          enctype="multipart/form-data">

      <div class="input-group">
        <!-- NOMBRE -->
        <input type="text" 
               name="nombre" 
               value="{{ usuario.nombre }}" 
               placeholder="Nombre"
               required>

        <!-- ROL -->
        <select name="rol" required>
            <option value="">Rol</option>
            <option value="Admin"      {% if usuario.rol == 'Admin' %}selected{% endif %}>Administrador</option>
            <option value="Guia"       {% if usuario.rol == 'Guia' %}selected{% endif %}>Guia</option>
            <option value="Cuidador"   {% if usuario.rol == 'Cuidador' %}selected{% endif %}>Cuidador</option>
            <option value="RRHH"       {% if usuario.rol == 'RRHH' %}selected{% endif %}>RRHH</option>
        </select>

        <!-- APELLIDO -->
        <input type="text" 
               name="apellido" 
               value="{{ usuario.apellido }}" 
               placeholder="Apellido">

        <!-- DOCUMENTO -->
        <input type="text" 
               name="documento" 
               value="{{ usuario.documento }}" 
               placeholder="Documento">

        <!-- TELÉFONO -->
        <input type="text" 
               name="telefono" 
               value="{{ usuario.telefono }}" 
               placeholder="Teléfono">

        <!-- CORREO -->
        <input type="email" 
               name="correo" 
               value="{{ usuario.correo }}" 
               placeholder="Correo" 
               required>

        <!-- FOTO ACTUAL -->
        <label style="margin-top: 10px;">Foto actual:</label>
        {% if usuario.foto %}
          <img src="{{ url_for('static', filename='uploads/' ~ usuario.foto) }}" 
               class="img-thumbnail" width="160" style="margin-bottom: 10px;">
        {% else %}
          <p>No hay foto registrada</p>
        {% endif %}

        <!-- CAMBIAR FOTO -->
        <input type="file" name="foto" accept="image/*">
      </div>

      <button type="submit" class="btn">Guardar Cambios</button>
    </form>
  </div>

  <!-- Sección derecha: bienvenida -->
  <div class="login-welcome">
    <h2>Editar Usuario</h2>
    <p>Modifica la información del usuario seleccionado</p>

    <a href="{{ url_for('auth.ver_usuario', idUsuario=usuario.idUsuario) }}" 
       class="btn-back">Regresar</a>
  </div>

</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/Contraseña.js') }}"></script>
{% endblock %}
